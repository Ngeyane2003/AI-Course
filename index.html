<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn & Earn AI â€” Courses & Bundle</title>
    
    <!-- SECURE PAYPAL SDK LOADER -->
    <script>
    async function loadPayPalSDK() {
      try {
        const response = await fetch('/api/get-client-id');
        if (!response.ok) throw new Error('Failed to fetch Client ID');
        
        const data = await response.json();
        if (!data.clientId) throw new Error('No Client ID received');

        const script = document.createElement('script');
        script.src = `https://www.paypal.com/sdk/js?client-id=${data.clientId}&currency=USD`;
        
        script.onload = () => {
          console.log('PayPal SDK loaded successfully!');
          if (typeof initLandingPayPalButtons === 'function') {
            initLandingPayPalButtons();
          }
        };
        
        script.onerror = () => {
          console.error('Failed to load PayPal SDK');
          document.querySelectorAll('.paypal-buttons').forEach(container => {
            container.innerHTML = `
              <div style="text-align: center; padding: 20px; color: var(--danger);">
                <p>Payment system temporarily unavailable. Please try again later.</p>
                <button class="btn small" onclick="loadPayPalSDK()">
                  <i class="fas fa-refresh"></i> Retry
                </button>
              </div>
            `;
          });
        };
        
        document.head.appendChild(script);
        
      } catch (error) {
        console.error('Error loading PayPal SDK:', error);
      }
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentContentLoaded', loadPayPalSDK);
    } else {
      loadPayPalSDK();
    }
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* [ALL YOUR EXISTING CSS STYLES REMAIN EXACTLY THE SAME] */
        :root {
            --primary: #003087;
            --secondary: #0070ba;
            --accent: #7aa2ff;
            --light: #f5f7fa;
            --dark: #0b0f19;
            --success: #16a34a;
            --warning: #f59e0b;
            --danger: #dc3545;
            --card-bg: #11182a;
            --border: rgba(255, 255, 255, 0.08);
            --text: #e8eefc;
            --muted: #b6c2e2;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(180deg, var(--dark) 0%, #0c1222 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* [REST OF YOUR CSS REMAINS EXACTLY THE SAME] */
        /* ... all your existing styles ... */
    </style>
</head>
<body>
    <!-- [ALL YOUR EXISTING HTML CONTENT REMAINS EXACTLY THE SAME] -->
    <!-- ====== Main Landing Page ====== -->
    <div id="landing-page">
        <!-- ====== Header / Nav ====== -->
        <header class="site-header">
            <div class="container nav">
                <a class="brand" href="#top" aria-label="Homepage">
                    <span class="brand-mark" aria-hidden="true">ðŸ¤–</span>
                    <span class="brand-text">Learn & Earn AI</span>
                </a>
                <button class="nav-toggle" aria-label="Toggle menu" aria-expanded="false">â˜°</button>
                <nav class="nav-links" aria-label="Primary">
                    <a href="#about">About</a>
                    <a href="#courses">Courses</a>
                    <a href="#pricing">Pricing</a>
                    <a href="#faq">FAQ</a>
                    <a class="btn small" href="#apply">Apply</a>
                </nav>
            </div>
        </header>

        <main id="top">
            <!-- [ALL YOUR EXISTING SECTIONS REMAIN EXACTLY THE SAME] -->
            <!-- Hero, About, Courses, Pricing, FAQ, Apply sections -->
            <!-- ... all your existing content ... -->
        </main>

        <!-- ====== Footer ====== -->
        <footer class="site-footer">
            <div class="container footer-grid">
                <div>
                    <div class="brand">
                        <span class="brand-mark" aria-hidden="true">ðŸ¤–</span>
                        <span class="brand-text">Learn & Earn AI</span>
                    </div>
                    <p class="fine">Â© <span id="year"></span> Learn & Earn AI. All rights reserved.</p>
                </div>
                <nav aria-label="Footer">
                    <a href="#about">About</a>
                    <a href="#courses">Courses</a>
                    <a href="#pricing">Pricing</a>
                    <a href="#apply">Apply</a>
                </nav>
            </div>
        </footer>
    </div>

    <!-- ====== Syllabus Pages ====== -->
    <!-- [ALL YOUR EXISTING SYLLABUS PAGES REMAIN EXACTLY THE SAME] -->
    <!-- AI for Everyone, Engineering, Business syllabus pages -->
    <!-- ... all your existing content ... -->

    <script>
        // Mobile nav toggle
        const navToggle = document.querySelector('.nav-toggle');
        const navLinks = document.querySelector('.nav-links');
        if (navToggle) {
            navToggle.addEventListener('click', () => {
                const isOpen = navLinks.classList.toggle('open');
                navToggle.setAttribute('aria-expanded', String(isOpen));
            });
        }

        // Year
        document.getElementById('year').textContent = new Date().getFullYear();

        // Smooth scroll for in-page links
        document.querySelectorAll('a[href^="#"]').forEach(a => {
            a.addEventListener('click', (e) => {
                const targetId = a.getAttribute('href').slice(1);
                const target = document.getElementById(targetId);
                if (target) {
                    e.preventDefault();
                    target.scrollIntoView({ behavior: 'smooth' });
                    if (navLinks && navLinks.classList.contains('open')) {
                        navLinks.classList.remove('open');
                        navToggle.setAttribute('aria-expanded', 'false');
                    }
                }
            });
        });

        // Form handling
        const form = document.getElementById('apply-form');
        const status = document.getElementById('form-status');
        
        if (form) {
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                status.textContent = 'Submitting...';
                
                // Simulate form submission
                setTimeout(() => {
                    form.reset();
                    status.textContent = 'Thanks! We received your application.';
                    status.style.color = 'var(--success)';
                }, 1500);
            });
        }

        // Show syllabus page
        function showSyllabus(courseId) {
            document.getElementById('landing-page').style.display = 'none';
            document.getElementById(courseId).style.display = 'block';
            
            // Initialize PayPal buttons for this course
            initPayPalButtons(courseId);
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Show landing page
        function showLandingPage() {
            document.querySelectorAll('.syllabus-page').forEach(page => {
                page.style.display = 'none';
            });
            document.getElementById('landing-page').style.display = 'block';
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Initialize PayPal buttons with SERVER-SIDE API calls
        function initPayPalButtons(courseId) {
            // SAFETY CHECK - Ensure PayPal is loaded
            if (typeof paypal === 'undefined') {
                console.error('PayPal SDK not loaded yet');
                setTimeout(() => initPayPalButtons(courseId), 1000);
                return;
            }
            
            // Clear previous buttons
            document.querySelectorAll('.paypal-buttons').forEach(div => {
                div.innerHTML = '';
            });
            
            // Create new buttons with SERVER-SIDE integration
            let buttonContainer, price, description;
            
            switch(courseId) {
                case 'ai-for-everyone':
                    buttonContainer = 'paypal-button-ai-everyone';
                    price = '197.00';
                    description = 'AI for Everyone Course';
                    break;
                case 'ai-for-engineering':
                    buttonContainer = 'paypal-button-ai-engineering';
                    price = '297.00';
                    description = 'AI for Engineering Course';
                    break;
                case 'ai-for-business':
                    buttonContainer = 'paypal-button-ai-business';
                    price = '247.00';
                    description = 'AI for Business Course';
                    break;
                default:
                    // Bundle buttons with SERVER-SIDE calls
                    paypal.Buttons({
                        createOrder: function(data, actions) {
                            // Call your Vercel serverless function
                            return fetch('/api/create-order', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    value: '397.00',
                                    description: 'AI Starter Bundle (Everyone + Business)'
                                })
                            }).then(res => res.json())
                                .then(order => order.id);
                        },
                        onApprove: function(data, actions) {
                            // Call your Vercel serverless function
                            return fetch('/api/capture-order', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    orderID: data.orderID
                                })
                            }).then(res => res.json())
                                .then(details => {
                                    showPaymentSuccess('AI Starter Bundle', details);
                                });
                        }
                    }).render('#paypal-button-starter-bundle');

                    paypal.Buttons({
                        createOrder: function(data, actions) {
                            // Call your Vercel serverless function
                            return fetch('/api/create-order', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    value: '597.00',
                                    description: 'AI Mastery Bundle (All Three Courses)'
                                })
                            }).then(res => res.json())
                                .then(order => order.id);
                        },
                        onApprove: function(data, actions) {
                            // Call your Vercel serverless function
                            return fetch('/api/capture-order', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    orderID: data.orderID
                                })
                            }).then(res => res.json())
                                .then(details => {
                                    showPaymentSuccess('AI Mastery Bundle', details);
                                });
                        }
                    }).render('#paypal-button-mastery-bundle');
                    return;
            }
            
            // Individual course buttons with SERVER-SIDE calls
            paypal.Buttons({
                createOrder: function(data, actions) {
                    // Call your Vercel serverless function
                    return fetch('/api/create-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            value: price,
                            description: description
                        })
                    }).then(res => res.json())
                        .then(order => order.id);
                },
                onApprove: function(data, actions) {
                    // Call your Vercel serverless function
                    return fetch('/api/capture-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            orderID: data.orderID
                        })
                    }).then(res => res.json())
                        .then(details => {
                            showPaymentSuccess(description, details);
                        });
                },
                onError: function(err) {
                    console.error('PayPal error:', err);
                    alert('There was an error with the payment. Please try again.');
                }
            }).render('#' + buttonContainer);
        }

        // Enhanced payment success function
        function showPaymentSuccess(productName, details) {
            const successHTML = `
                <div style="text-align: center; padding: 30px; background: var(--card-bg); border-radius: 16px; margin: 20px 0;">
                    <div style="font-size: 60px; color: var(--success); margin-bottom: 20px;">âœ“</div>
                    <h2>Payment Successful!</h2>
                    <p>Thank you for purchasing ${productName}.</p>
                    <p>Transaction ID: ${details.id}</p>
                    <p>We've sent a confirmation email to ${details.payer.email_address}.</p>
                    <p>You will receive access to the course within 24 hours.</p>
                    <button class="btn" onclick="showLandingPage()" style="margin-top: 20px;">
                        <i class="fas fa-home"></i> Return to Home
                    </button>
                </div>
            `;
            
            // Replace all PayPal buttons with success message
            document.querySelectorAll('.paypal-buttons').forEach(div => {
                div.innerHTML = successHTML;
            });
        }

        // Initialize PayPal buttons for landing page
        function initLandingPayPalButtons() {
            // SAFETY CHECK - Ensure PayPal is loaded
            if (typeof paypal === 'undefined') {
                console.error('PayPal SDK not loaded yet');
                setTimeout(initLandingPayPalButtons, 1000);
                return;
            }
            
            // Starter Bundle
            paypal.Buttons({
                createOrder: function(data, actions) {
                    return fetch('/api/create-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            value: '397.00',
                            description: 'AI Starter Bundle (Everyone + Business)'
                        })
                    }).then(res => res.json())
                        .then(order => order.id);
                },
                onApprove: function(data, actions) {
                    return fetch('/api/capture-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            orderID: data.orderID
                        })
                    }).then(res => res.json())
                        .then(details => {
                            showPaymentSuccess('AI Starter Bundle', details);
                        });
                }
            }).render('#paypal-button-starter-bundle-landing');

            // Mastery Bundle
            paypal.Buttons({
                createOrder: function(data, actions) {
                    return fetch('/api/create-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            value: '597.00',
                            description: 'AI Mastery Bundle (All Three Courses)'
                        })
                    }).then(res => res.json())
                        .then(order => order.id);
                },
                onApprove: function(data, actions) {
                    return fetch('/api/capture-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            orderID: data.orderID
                        })
                    }).then(res => res.json())
                        .then(details => {
                            showPaymentSuccess('AI Mastery Bundle', details);
                        });
                }
            }).render('#paypal-button-mastery-bundle-landing');

            // Individual courses
            paypal.Buttons({
                createOrder: function(data, actions) {
                    return fetch('/api/create-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            value: '197.00',
                            description: 'AI for Everyone Course'
                        })
                    }).then(res => res.json())
                        .then(order => order.id);
                },
                onApprove: function(data, actions) {
                    return fetch('/api/capture-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            orderID: data.orderID
                        })
                    }).then(res => res.json())
                        .then(details => {
                            showPaymentSuccess('AI for Everyone Course', details);
                        });
                }
            }).render('#paypal-button-ai-everyone-landing');

            paypal.Buttons({
                createOrder: function(data, actions) {
                    return fetch('/api/create-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            value: '297.00',
                            description: 'AI for Engineering Course'
                        })
                    }).then(res => res.json())
                        .then(order => order.id);
                },
                onApprove: function(data, actions) {
                    return fetch('/api/capture-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            orderID: data.orderID
                        })
                    }).then(res => res.json())
                        .then(details => {
                            showPaymentSuccess('AI for Engineering Course', details);
                        });
                }
            }).render('#paypal-button-ai-engineering-landing');

            paypal.Buttons({
                createOrder: function(data, actions) {
                    return fetch('/api/create-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            value: '247.00',
                            description: 'AI for Business Course'
                        })
                    }).then(res => res.json())
                        .then(order => order.id);
                },
                onApprove: function(data, actions) {
                    return fetch('/api/capture-order', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            orderID: data.orderID
                        })
                    }).then(res => res.json())
                        .then(details => {
                            showPaymentSuccess('AI for Business Course', details);
                        });
                }
            }).render('#paypal-button-ai-business-landing');
        }

        // Animation on scroll
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.course-link, details, .price-card').forEach(el => {
            observer.observe(el);
        });
    </script>
</body>
</html>
